<Window x:Class="SpeechToTextTray.UI.Windows.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:SpeechToTextTray.UI.Controls"
        Title="Speech-to-Text Settings"
        Height="600" Width="550"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Background="#F0F0F0">

    <Window.Resources>
        <Style TargetType="Label">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,15,0,5"/>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Height" Value="30"/>
        </Style>
        <Style TargetType="ComboBox">
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Height" Value="30"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Margin" Value="0,5,0,0"/>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Settings Content -->
        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Hotkey Section -->
                <Label Content="Recording Hotkey:" FontSize="14"/>
                <controls:HotkeyTextBox x:Name="hotkeyInput" Height="30"/>
                <TextBlock Text="Press a key combination to set the hotkey (requires at least one modifier key)"
                           Foreground="Gray"
                           FontSize="10"
                           Margin="0,3,0,0"
                           TextWrapping="Wrap"/>

                <!-- Audio Device Section -->
                <Label Content="Microphone:" FontSize="14" Margin="0,20,0,5"/>
                <ComboBox x:Name="audioDeviceCombo"
                          DisplayMemberPath="Name"
                          SelectedValuePath="Id"/>
                <TextBlock Text="Select the audio input device for recording"
                           Foreground="Gray"
                           FontSize="10"
                           Margin="0,3,0,0"/>

                <!-- Transcription Provider Section -->
                <Label Content="Transcription Provider:" FontSize="14" Margin="0,20,0,5"/>
                <RadioButton x:Name="localProviderRadio"
                             GroupName="TranscriptionProvider"
                             Content="Local (Offline) - sherpa-onnx"
                             Margin="0,5,0,5"
                             Checked="OnProviderChanged"/>
                <RadioButton x:Name="azureProviderRadio"
                             GroupName="TranscriptionProvider"
                             Content="Azure Speech Service (Cloud)"
                             Margin="0,0,0,5"
                             Checked="OnProviderChanged"/>
                <RadioButton x:Name="azureOpenAIProviderRadio"
                             GroupName="TranscriptionProvider"
                             Content="Azure OpenAI Whisper (Cloud)"
                             Margin="0,0,0,10"
                             Checked="OnProviderChanged"/>

                <!-- Azure Configuration Panel -->
                <Border x:Name="azureConfigPanel"
                        Visibility="Collapsed"
                        BorderBrush="#CCCCCC"
                        BorderThickness="1"
                        Padding="15"
                        Margin="0,0,0,0"
                        Background="White">
                    <StackPanel>
                        <TextBlock Text="Azure Configuration" FontWeight="Bold" FontSize="12" Margin="0,0,0,10"/>

                        <!-- Subscription Key -->
                        <Label Content="Subscription Key:" Margin="0,5,0,5"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBox x:Name="azureKeyInput"
                                     Grid.Column="0"
                                     Height="30"
                                     Padding="5"/>
                            <Button x:Name="testConnectionButton"
                                    Content="Test"
                                    Grid.Column="1"
                                    Width="60"
                                    Height="30"
                                    Margin="5,0,0,0"
                                    Click="TestAzureConnection_Click"/>
                        </Grid>
                        <TextBlock Text="Your Azure Speech Service subscription key"
                                   Foreground="Gray"
                                   FontSize="10"
                                   Margin="0,3,0,0"/>

                        <!-- Region -->
                        <Label Content="Region:" Margin="0,10,0,5"/>
                        <ComboBox x:Name="azureRegionCombo" Height="30">
                            <ComboBoxItem Content="East US" Tag="eastus" IsSelected="True"/>
                            <ComboBoxItem Content="West US 2" Tag="westus2"/>
                            <ComboBoxItem Content="West Europe" Tag="westeurope"/>
                            <ComboBoxItem Content="North Europe" Tag="northeurope"/>
                            <ComboBoxItem Content="Sweden Central" Tag="swedencentral"/>
                            <ComboBoxItem Content="UK South" Tag="uksouth"/>
                            <ComboBoxItem Content="Southeast Asia" Tag="southeastasia"/>
                            <ComboBoxItem Content="Australia East" Tag="australiaeast"/>
                        </ComboBox>
                        <TextBlock Text="Select the Azure region closest to you"
                                   Foreground="Gray"
                                   FontSize="10"
                                   Margin="0,3,0,0"/>

                        <!-- Language (Optional) -->
                        <Label Content="Language (optional):" Margin="0,10,0,5"/>
                        <ComboBox x:Name="azureLanguageCombo" Height="30">
                            <ComboBoxItem Content="Auto-detect" Tag="" IsSelected="True"/>
                            <ComboBoxItem Content="English (US)" Tag="en-US"/>
                            <ComboBoxItem Content="English (UK)" Tag="en-GB"/>
                            <ComboBoxItem Content="German" Tag="de-DE"/>
                            <ComboBoxItem Content="French" Tag="fr-FR"/>
                            <ComboBoxItem Content="Spanish" Tag="es-ES"/>
                            <ComboBoxItem Content="Italian" Tag="it-IT"/>
                            <ComboBoxItem Content="Portuguese" Tag="pt-PT"/>
                            <ComboBoxItem Content="Dutch" Tag="nl-NL"/>
                            <ComboBoxItem Content="Polish" Tag="pl-PL"/>
                            <ComboBoxItem Content="Russian" Tag="ru-RU"/>
                        </ComboBox>
                        <TextBlock Text="Leave as Auto-detect for automatic language recognition"
                                   Foreground="Gray"
                                   FontSize="10"
                                   Margin="0,3,0,0"/>

                        <!-- Status Indicator -->
                        <StackPanel Orientation="Horizontal" Margin="0,15,0,5">
                            <Ellipse x:Name="azureStatusIndicator"
                                     Width="10" Height="10"
                                     Fill="Gray"
                                     Margin="0,0,5,0"/>
                            <TextBlock x:Name="azureStatusText" Text="Not tested" FontSize="11"/>
                        </StackPanel>

                        <!-- Help Text -->
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="#666666"
                                   FontSize="10"
                                   Margin="0,10,0,0">
                            <Run Text="Azure Speech Service requires internet. "/>
                            <Hyperlink NavigateUri="https://azure.microsoft.com/services/cognitive-services/speech-services/" RequestNavigate="Hyperlink_RequestNavigate">Get started</Hyperlink>
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!-- Azure OpenAI Configuration Panel -->
                <Border x:Name="azureOpenAIConfigPanel"
                        Visibility="Collapsed"
                        BorderBrush="#CCCCCC"
                        BorderThickness="1"
                        Padding="15"
                        Margin="0,0,0,0"
                        Background="White">
                    <StackPanel>
                        <TextBlock Text="Azure OpenAI Configuration" FontWeight="Bold" FontSize="12" Margin="0,0,0,10"/>

                        <!-- Endpoint URL -->
                        <Label Content="Endpoint URL:" Margin="0,5,0,5"/>
                        <TextBox x:Name="azureOpenAIEndpointInput"
                                 Height="30"
                                 Padding="5"/>
                        <TextBlock Text="Example: https://your-resource.openai.azure.com/"
                                   Foreground="Gray"
                                   FontSize="10"
                                   Margin="0,3,0,0"/>

                        <!-- API Key -->
                        <Label Content="API Key:" Margin="0,10,0,5"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <PasswordBox x:Name="azureOpenAIKeyInput"
                                         Grid.Column="0"
                                         Height="30"
                                         Padding="5"/>
                            <Button x:Name="testOpenAIConnectionButton"
                                    Content="Test"
                                    Grid.Column="1"
                                    Width="60"
                                    Height="30"
                                    Margin="5,0,0,0"
                                    Click="TestAzureOpenAIConnection_Click"/>
                        </Grid>
                        <TextBlock Text="Your Azure OpenAI API key"
                                   Foreground="Gray"
                                   FontSize="10"
                                   Margin="0,3,0,0"/>

                        <!-- Deployment Name -->
                        <Label Content="Deployment Name:" Margin="0,10,0,5"/>
                        <TextBox x:Name="azureOpenAIDeploymentInput"
                                 Height="30"
                                 Padding="5"/>
                        <TextBlock Text="The name of your Whisper deployment in Azure OpenAI Studio"
                                   Foreground="Gray"
                                   FontSize="10"
                                   Margin="0,3,0,0"/>

                        <!-- Language (Optional) -->
                        <Label Content="Language (optional):" Margin="0,10,0,5"/>
                        <ComboBox x:Name="azureOpenAILanguageCombo" Height="30">
                            <ComboBoxItem Content="Auto-detect" Tag="" IsSelected="True"/>
                            <ComboBoxItem Content="English" Tag="en"/>
                            <ComboBoxItem Content="German" Tag="de"/>
                            <ComboBoxItem Content="French" Tag="fr"/>
                            <ComboBoxItem Content="Spanish" Tag="es"/>
                            <ComboBoxItem Content="Italian" Tag="it"/>
                            <ComboBoxItem Content="Portuguese" Tag="pt"/>
                            <ComboBoxItem Content="Dutch" Tag="nl"/>
                            <ComboBoxItem Content="Polish" Tag="pl"/>
                            <ComboBoxItem Content="Russian" Tag="ru"/>
                            <ComboBoxItem Content="Chinese" Tag="zh"/>
                            <ComboBoxItem Content="Japanese" Tag="ja"/>
                        </ComboBox>
                        <TextBlock Text="Leave as Auto-detect for automatic language recognition"
                                   Foreground="Gray"
                                   FontSize="10"
                                   Margin="0,3,0,0"/>

                        <!-- Prompt (Optional) -->
                        <Label Content="Prompt (optional):" Margin="0,10,0,5"/>
                        <TextBox x:Name="azureOpenAIPromptInput"
                                 Height="30"
                                 Padding="5"/>
                        <TextBlock Text="Optional text to guide transcription (improves accuracy for specific terminology)"
                                   Foreground="Gray"
                                   FontSize="10"
                                   Margin="0,3,0,0"/>

                        <!-- Status Indicator -->
                        <StackPanel Orientation="Horizontal" Margin="0,15,0,5">
                            <Ellipse x:Name="azureOpenAIStatusIndicator"
                                     Width="10" Height="10"
                                     Fill="Gray"
                                     Margin="0,0,5,0"/>
                            <TextBlock x:Name="azureOpenAIStatusText" Text="Not tested" FontSize="11"/>
                        </StackPanel>

                        <!-- Help Text -->
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="#666666"
                                   FontSize="10"
                                   Margin="0,10,0,0">
                            <Run Text="Azure OpenAI Whisper requires internet. 25MB file size limit. "/>
                            <Hyperlink NavigateUri="https://learn.microsoft.com/en-us/azure/ai-services/openai/whisper-quickstart" RequestNavigate="Hyperlink_RequestNavigate">Get started</Hyperlink>
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!-- Options Section -->
                <Label Content="Options:" FontSize="14" Margin="0,20,0,5"/>
                <CheckBox x:Name="showNotificationsCheck"
                          Content="Show notifications"/>
                <CheckBox x:Name="injectTextCheck"
                          Content="Automatically inject text into active window"/>
                <CheckBox x:Name="fallbackClipboardCheck"
                          Content="Fallback to clipboard if text injection fails"
                          Margin="20,5,0,0"/>
                <CheckBox x:Name="enableSpeechMikeCheck"
                          Content="Enable SpeechMike integration"/>
            </StackPanel>
        </ScrollViewer>

        <!-- Buttons -->
        <StackPanel Grid.Row="1"
                   Orientation="Horizontal"
                   HorizontalAlignment="Right"
                   Margin="0,20,0,0">
            <Button Content="Reset to Defaults"
                    Width="120"
                    Height="35"
                    Margin="0,0,10,0"
                    Click="Reset_Click"/>
            <Button Content="Cancel"
                    Width="80"
                    Height="35"
                    Margin="0,0,10,0"
                    Click="Cancel_Click"/>
            <Button Content="Save"
                    Width="80"
                    Height="35"
                    IsDefault="True"
                    Background="#0078D4"
                    Foreground="White"
                    Click="Save_Click"/>
        </StackPanel>
    </Grid>
</Window>
